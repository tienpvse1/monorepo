var K=Object.defineProperty,Y=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var k=(t,e,o)=>e in t?K(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,b=(t,e)=>{for(var o in e||(e={}))G.call(e,o)&&k(t,o,e[o]);if(M)for(var o of M(e))J.call(e,o)&&k(t,o,e[o]);return t},w=(t,e)=>Y(t,q(e));import{r as u,A as W,_ as A,z as T,ap as X,x as j,J as Z,j as r,L as ee,h as E,F as D,B as S,P as te,I as C,a5 as ne}from"./vendor.1ad7f0a1.js";import{A as I}from"./index.25619e45.js";import{c as L}from"./controllers.5aba4075.js";import{a as x}from"./index.70491956.js";var oe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},ae=oe,O=function(e,o){return u.exports.createElement(W,A(A({},e),{},{ref:o,icon:ae}))};O.displayName="InboxOutlined";var re=u.exports.forwardRef(O);const P={okText:"Agree",cancelText:"Abort",closable:!0,content:"",onOk:()=>console.log("ok"),onCancel:()=>console.log("canceled")},se=(t="",e)=>w(b({},P),{content:t,onOk:e,onCancel:T.destroyAll}),ie=(t="",e)=>w(b({},P),{content:t,onOk:e}),$=(t="Notification",e="")=>{X.open({type:"success",message:t,description:e,onClick:()=>{console.log("Notification Clicked!")}})},{EMAIL_TEMPLATE:ce}=L,le=async({id:t,design:e})=>{const{instance:o}=new I,{data:n}=await o.patch(`${ce}/${t}`,{design:e});return n},de=()=>j(le),{EMAIL_TEMPLATE:H}=L,f="fetch-templates",pe=async(t="")=>{const{instance:e}=new I,{data:o}=await e.get(`${H}/${t}`);return o.data},R=async()=>{const{instance:t}=new I,{data:e}=await t.get(`${H}`);return e.data},ue=()=>Z(f,R),{EMAIL_TEMPLATE:me}=L,fe=async({design:t,name:e})=>{const{instance:o}=new I,{data:n}=await o.post(`${me}`,{name:e,design:t});return n},he=()=>j(fe,{onMutate:async t=>{await x.cancelQueries(f);const e=x.getQueryData(f);if(e)return x.setQueryData(f,[...e,w(b({},t),{id:Date.now().toString()})]),{previousItems:e};{const o=[w(b({},t),{id:Date.now().toString()})];return x.setQueryData(f,o),{previousItems:o}}},onError:(t,e,o)=>{(o==null?void 0:o.previousItems)&&x.setQueryData(f,o.previousItems)},onSettled:()=>{x.invalidateQueries(f)}}),ve=({design:t,onClose:e})=>{const[o,n]=u.exports.useState(!1),{data:a,isLoading:s}=ue(),i=de(),{mutate:l}=he(),m=()=>n(!o),[h,d]=u.exports.useState("");if(s)return r(ee,{type:"cubes"});const v=c=>{c.key==="Enter"&&(n(!1),l({design:t,name:h}),d(""),e())},g=c=>{n(!1),i.mutate({id:c,design:t})};return E("div",{children:[a&&a.length>0?E(D,{children:[r("h3",{children:"Available templates"}),r("ul",{style:{transform:"translateX(-20px)"},children:a.map((c,y)=>r("li",{style:{cursor:"pointer"},onClick:()=>{o||(e(),g(c.id||""))},children:c.name},y))})]}):E("div",{style:{display:"flex",alignItems:"center",flexDirection:"column"},children:[r(re,{style:{fontSize:60,color:"rgba(0,0,0,0.35)"}}),r("p",{style:{fontWeight:"bold",color:"rgba(0,0,0,0.6)"},children:"There's no template"})]}),E("div",{children:[r(S,{style:{display:o?"none":"block"},type:"link",onClick:m,icon:r(te,{}),children:"Save as"}),o&&r(C,{suffix:r(S,{icon:r(ne,{}),type:"link",onClick:m}),onKeyDown:v,onChange:c=>d(c.target.value),placeholder:"Basic usage"})]})]})},ge=({modal:t,templates:e,handleLoad:o,setModal:n,design:a})=>{const s=()=>{n(""),$("success","Your email have updated successfully")};return E("div",{children:[r(T,{title:"Your templates...",visible:t==="selectTemplate",onCancel:()=>n("false"),children:e.map(i=>r("p",{style:{cursor:"pointer"},onClick:()=>{o((i==null?void 0:i.id)||""),n("false")},children:i.name},i.id))}),r(T,{title:"Save your template",visible:t==="saveTemplate",onCancel:()=>n("false"),children:r(ve,{design:a,onClose:s})})]})},{MAILER:ye}=L,be=async t=>{const{instance:e}=new I,{data:o}=await e.post(`${ye}/send`,b({},t));return o},Ee=t=>j(be,{onError:()=>t()});var xe="//editor.unlayer.com/embed.js?2",_=[],Q=!1,we=function(e){var o=document.querySelectorAll("script"),n=!1;return o.forEach(function(a){a.src.includes(e)&&(n=!0)}),n},Te=function(e){_.push(e)},N=function(){if(Q)for(var e=void 0;e=_.shift();)e()},Se=function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xe;if(Te(e),we(o))N();else{var n=document.createElement("script");n.setAttribute("src",o),n.onload=function(){Q=!0,N()},document.head.appendChild(n)}};const Ie="react-email-editor",Le="1.5.0",je="Unlayer's Email Editor Component for React.js",Ce="lib/index.js",Me="es/index.js",ke=["css","es","lib","umd"],Ae={build:"nwb build-react-component",clean:"nwb clean-module && nwb clean-demo",start:"nwb serve-react-demo",test:"nwb test-react","test:coverage":"nwb test-react --coverage","test:watch":"nwb test-react --server",release:"npm run build && npm publish"},De={},Oe={react:"15.x || 16.x"},Pe={nwb:"^0.22.0",react:"^16.13.1","react-dom":"^16.13.1","react-router-dom":"^5.2.0","styled-components":"^4.2.0"},$e="",He="https://github.com/unlayer/react-email-editor#readme",Re="MIT",_e="https://github.com/unlayer/react-email-editor.git",Qe=["react-component"];var U={name:Ie,version:Le,description:je,main:Ce,module:Me,files:ke,scripts:Ae,dependencies:De,peerDependencies:Oe,devDependencies:Pe,author:$e,homepage:He,license:Re,repository:_e,keywords:Qe},z=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t};function Ne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ue(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function ze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Be=0,Ve=function(t){ze(e,t);function e(o){Ne(this,e);var n=Ue(this,t.call(this,o));return n.loadEditor=function(){var a=n.props.options||{};n.props.projectId&&(a.projectId=n.props.projectId),n.props.tools&&(a.tools=n.props.tools),n.props.appearance&&(a.appearance=n.props.appearance),n.props.locale&&(a.locale=n.props.locale),n.editor=unlayer.createEditor(z({},a,{id:n.editorId,displayMode:"email",source:{name:U.name,version:U.version}}));for(var s=Object.entries(n.props),i=Array.isArray(s),l=0,s=i?s:s[Symbol.iterator]();;){var m;if(i){if(l>=s.length)break;m=s[l++]}else{if(l=s.next(),l.done)break;m=l.value}var h=m,d=h[0],v=h[1];/^on/.test(d)&&d!=="onLoad"&&d!=="onReady"&&n.addEventListener(d,v)}var g=n.props,c=g.onLoad,y=g.onReady;c&&c(),y&&n.editor.addEventListener("editor:ready",y)},n.registerCallback=function(a,s){n.editor.registerCallback(a,s)},n.addEventListener=function(a,s){n.editor.addEventListener(a,s)},n.loadDesign=function(a){n.editor.loadDesign(a)},n.saveDesign=function(a){n.editor.saveDesign(a)},n.exportHtml=function(a){n.editor.exportHtml(a)},n.setMergeTags=function(a){n.editor.setMergeTags(a)},n.editorId=o.editorId||"editor-"+ ++Be,n}return e.prototype.componentDidMount=function(){Se(this.loadEditor,this.props.scriptUrl)},e.prototype.render=function(){var n=this.props,a=n.minHeight,s=a===void 0?500:a,i=n.style,l=i===void 0?{}:i;return r("div",{style:{flex:1,display:"flex",minHeight:s},children:r("div",{id:this.editorId,style:z({},l,{flex:1})})})},e}(u.exports.Component);const Ze=()=>{const t=u.exports.useRef(null),[e,o]=u.exports.useState([]),[n,a]=u.exports.useState(""),[s,i]=u.exports.useState(),[l,m]=u.exports.useState(""),[h,d]=u.exports.useState(""),[v,g]=T.useModal(),c=()=>{v.error(se("cannot send email",T.destroyAll))},{mutate:y,isLoading:B}=Ee(c),V=()=>{t.current&&t.current.exportHtml(p=>{y({subject:l,to:n,value:p.html})})};return E(D,{children:[r(ge,{templates:e,modal:h,handleLoad:async p=>{if(!t.current)return;const F=await pe(p);t.current.loadDesign(F.design),$("Notification","Email template have been loaded successfully")},setModal:d,design:s}),r(C,{placeholder:"to",onChange:p=>a(p.target.value)}),r(C,{placeholder:"Email subject",onChange:p=>m(p.target.value),type:"email"}),r(Ve,{ref:t,options:{customCSS:["https://examples.unlayer.com/examples/custom-css/custom.css"]},appearance:{theme:"light"}}),r(S,{onClick:()=>{!t.current||t.current.saveDesign(p=>{i(p),d("saveTemplate")})},style:{marginRight:12},type:"primary",danger:!0,children:"Save"}),r(S,{onClick:async()=>{const p=await R();o(p),d("selectTemplate")},style:{marginRight:12},type:"primary",danger:!0,children:"Load"}),r(S,{style:{marginRight:12},onClick:()=>{v.warning(ie(`this email will be sent to ${n}`,V))},type:"primary",danger:!0,disabled:n.length>0,loading:B,children:"Send"}),g]})};export{Ze as default};
